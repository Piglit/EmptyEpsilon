From 19c65030d682bd297a0c2029e975f2e5602cb837 Mon Sep 17 00:00:00 2001
From: Pithlit <piglit@mail.de>
Date: Wed, 2 Nov 2022 16:04:10 +0100
Subject: [PATCH 4/7] auto-commands for template

---
 src/shipTemplate.cpp                 | 2 ++
 src/shipTemplate.h                   | 4 ++++
 src/spaceObjects/playerSpaceship.cpp | 3 +++
 3 files changed, 9 insertions(+)

diff --git a/src/shipTemplate.cpp b/src/shipTemplate.cpp
index 9b8acda9..6e82125c 100644
--- a/src/shipTemplate.cpp
+++ b/src/shipTemplate.cpp
@@ -122,6 +122,8 @@ REGISTER_SCRIPT_CLASS(ShipTemplate)
     REGISTER_SCRIPT_CLASS_FUNCTION(ShipTemplate, setCanCombatManeuver);
     REGISTER_SCRIPT_CLASS_FUNCTION(ShipTemplate, setCanSelfDestruct);
     REGISTER_SCRIPT_CLASS_FUNCTION(ShipTemplate, setCanLaunchProbe);
+    REGISTER_SCRIPT_CLASS_FUNCTION(ShipTemplate, setAutoCoolant);
+    REGISTER_SCRIPT_CLASS_FUNCTION(ShipTemplate, setAutoRepair);
     REGISTER_SCRIPT_CLASS_FUNCTION(ShipTemplate, setAutoMissileReload);
     /// Return a new template with the given name, which is an exact copy of this template.
     /// Used to make easy variations of templates.
diff --git a/src/shipTemplate.h b/src/shipTemplate.h
index f3b11ac5..51bfc489 100644
--- a/src/shipTemplate.h
+++ b/src/shipTemplate.h
@@ -106,6 +106,8 @@ public:
     bool can_launch_probe = true;
 
     // Ship automation features, mostly for single-person ships like fighters
+    bool auto_repair_enabled = false;
+    bool auto_coolant_enabled = false;
     bool auto_reload_tube_enabled = false;
 
     float energy_storage_amount;
@@ -156,6 +158,8 @@ public:
     void setCanCombatManeuver(bool enabled) { can_combat_maneuver = enabled; }
     void setCanSelfDestruct(bool enabled) { can_self_destruct = enabled; }
     void setCanLaunchProbe(bool enabled) { can_launch_probe = enabled; }
+    void setAutoCoolant(bool active) { auto_coolant_enabled = active; }
+    void setAutoRepair(bool active) { auto_repair_enabled = active; }
     void setAutoMissileReload(bool active) { auto_reload_tube_enabled = active; }
     void setMesh(string model, string color_texture, string specular_texture, string illumination_texture);
     void setEnergyStorage(float energy_amount);
diff --git a/src/spaceObjects/playerSpaceship.cpp b/src/spaceObjects/playerSpaceship.cpp
index 3773d187..559d4595 100644
--- a/src/spaceObjects/playerSpaceship.cpp
+++ b/src/spaceObjects/playerSpaceship.cpp
@@ -761,6 +761,9 @@ void PlayerSpaceship::applyTemplateValues()
     can_combat_maneuver = ship_template->can_combat_maneuver;
     can_self_destruct = ship_template->can_self_destruct;
     can_launch_probe = ship_template->can_launch_probe;
+    auto_repair_enabled = ship_template->auto_repair_enabled;
+    auto_coolant_enabled = ship_template->auto_coolant_enabled;
+    auto_reload_tube_enabled = ship_template->auto_reload_tube_enabled;
     if (!on_new_player_ship_called)
     {
         on_new_player_ship_called = true;
-- 
2.39.1

